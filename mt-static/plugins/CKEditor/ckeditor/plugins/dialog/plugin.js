CKEDITOR.DIALOG_RESIZE_NONE=0;CKEDITOR.DIALOG_RESIZE_WIDTH=1;CKEDITOR.DIALOG_RESIZE_HEIGHT=2;CKEDITOR.DIALOG_RESIZE_BOTH=3;(function(){var a=CKEDITOR.tools.cssLength;function b(F){return!!this._.tabs[F][0].$.offsetHeight;};function c(){var J=this;var F=J._.currentTabId,G=J._.tabIdList.length,H=CKEDITOR.tools.indexOf(J._.tabIdList,F)+G;for(var I=H-1;I>H-G;I--){if(b.call(J,J._.tabIdList[I%G]))return J._.tabIdList[I%G];}return null;};function d(){var J=this;var F=J._.currentTabId,G=J._.tabIdList.length,H=CKEDITOR.tools.indexOf(J._.tabIdList,F);for(var I=H+1;I<H+G;I++){if(b.call(J,J._.tabIdList[I%G]))return J._.tabIdList[I%G];}return null;};function e(F,G){var H=F.$.getElementsByTagName('input');for(var I=0,J=H.length;I<J;I++){var K=new CKEDITOR.dom.element(H[I]);if(K.getAttribute('type').toLowerCase()=='text')if(G){K.setAttribute('value',K.getCustomData('fake_value')||'');K.removeCustomData('fake_value');}else{K.setCustomData('fake_value',K.getAttribute('value'));K.setAttribute('value','');}}};function f(F,G){var I=this;var H=I.getInputElement();if(H)F?H.removeAttribute('aria-invalid'):H.setAttribute('aria-invalid',true);if(!F)if(I.select)I.select();else I.focus();G&&alert(G);I.fire('validated',{valid:F,msg:G});};function g(){var F=this.getInputElement();F&&F.removeAttribute('aria-invalid');};CKEDITOR.dialog=function(F,G){var H=CKEDITOR.dialog._.dialogDefinitions[G],I=CKEDITOR.tools.clone(j),J=F.config.dialog_buttonsOrder||'OS',K=F.lang.dir,L={},M,N,O;if(J=='OS'&&CKEDITOR.env.mac||J=='rtl'&&K=='ltr'||J=='ltr'&&K=='rtl')I.buttons.reverse();H=CKEDITOR.tools.extend(H(F),I);H=CKEDITOR.tools.clone(H);H=new n(this,H);var P=CKEDITOR.document,Q=F.theme.buildDialog(F);this._={editor:F,element:Q.element,name:G,contentSize:{width:0,height:0},size:{width:0,height:0},contents:{},buttons:{},accessKeyMap:{},tabs:{},tabIdList:[],currentTabId:null,currentTabIndex:null,pageCount:0,lastTab:null,tabBarMode:false,focusList:[],currentFocusIndex:0,hasFocus:false};this.parts=Q.parts;CKEDITOR.tools.setTimeout(function(){F.fire('ariaWidget',this.parts.contents);},0,this);var R={position:CKEDITOR.env.ie6Compat?'absolute':'fixed',top:0,visibility:'hidden'};R[K=='rtl'?'right':'left']=0;this.parts.dialog.setStyles(R);CKEDITOR.event.call(this);this.definition=H=CKEDITOR.fire('dialogDefinition',{name:G,definition:H},F).definition;if(!('removeDialogTabs' in F._)&&F.config.removeDialogTabs){var S=F.config.removeDialogTabs.split(';');for(M=0;M<S.length;M++){var T=S[M].split(':');if(T.length==2){var U=T[0];
if(!L[U])L[U]=[];L[U].push(T[1]);}}F._.removeDialogTabs=L;}if(F._.removeDialogTabs&&(L=F._.removeDialogTabs[G]))for(M=0;M<L.length;M++)H.removeContents(L[M]);if(H.onLoad)this.on('load',H.onLoad);if(H.onShow)this.on('show',H.onShow);if(H.onHide)this.on('hide',H.onHide);if(H.onOk)this.on('ok',function(af){F.fire('saveSnapshot');setTimeout(function(){F.fire('saveSnapshot');},0);if(H.onOk.call(this,af)===false)af.data.hide=false;});if(H.onCancel)this.on('cancel',function(af){if(H.onCancel.call(this,af)===false)af.data.hide=false;});var V=this,W=function(af){var ag=V._.contents,ah=false;for(var ai in ag)for(var aj in ag[ai]){ah=af.call(this,ag[ai][aj]);if(ah)return;}};this.on('ok',function(af){W(function(ag){if(ag.validate){var ah=ag.validate(this),ai=typeof ah=='string'||ah===false;if(ai){af.data.hide=false;af.stop();}f.call(ag,!ai,typeof ah=='string'?ah:undefined);return ai;}});},this,null,0);this.on('cancel',function(af){W(function(ag){if(ag.isChanged()){if(!confirm(F.lang.common.confirmCancel))af.data.hide=false;return true;}});},this,null,0);this.parts.close.on('click',function(af){if(this.fire('cancel',{hide:true}).hide!==false)this.hide();af.data.preventDefault();},this);function X(){var af=V._.focusList;af.sort(function(ai,aj){if(ai.tabIndex!=aj.tabIndex)return aj.tabIndex-ai.tabIndex;else return ai.focusIndex-aj.focusIndex;});var ag=af.length;for(var ah=0;ah<ag;ah++)af[ah].focusIndex=ah;};function Y(af){var ag=V._.focusList;af=af||0;if(ag.length<1)return;var ah=V._.currentFocusIndex;try{ag[ah].getInputElement().$.blur();}catch(ak){}var ai=(ah+af+ag.length)%ag.length,aj=ai;while(af&&!ag[aj].isFocusable()){aj=(aj+af+ag.length)%ag.length;if(aj==ai)break;}ag[aj].focus();if(ag[aj].type=='text')ag[aj].select();};this.changeFocus=Y;function Z(af){var am=this;if(V!=CKEDITOR.dialog._.currentTop)return;var ag=af.data.getKeystroke(),ah=F.lang.dir=='rtl',ai;N=O=0;if(ag==9||ag==CKEDITOR.SHIFT+9){var aj=ag==CKEDITOR.SHIFT+9;if(V._.tabBarMode){var ak=aj?c.call(V):d.call(V);V.selectPage(ak);V._.tabs[ak][0].focus();}else Y(aj?-1:1);N=1;}else if(ag==CKEDITOR.ALT+121&&!V._.tabBarMode&&V.getPageCount()>1){V._.tabBarMode=true;V._.tabs[V._.currentTabId][0].focus();N=1;}else if((ag==37||ag==39)&&V._.tabBarMode){ak=ag==(ah?39:37)?c.call(V):d.call(V);V.selectPage(ak);V._.tabs[ak][0].focus();N=1;}else if((ag==13||ag==32)&&V._.tabBarMode){am.selectPage(am._.currentTabId);am._.tabBarMode=false;am._.currentFocusIndex=-1;Y(1);N=1;}else if(ag==13){var al=af.data.getTarget();if(!al.is('a','button','select','textarea')&&(!al.is('input')||al.$.type!='button')){ai=am.getButton('ok');
ai&&CKEDITOR.tools.setTimeout(ai.click,0,ai);N=1;}O=1;}else if(ag==27){ai=am.getButton('cancel');if(ai)CKEDITOR.tools.setTimeout(ai.click,0,ai);else if(am.fire('cancel',{hide:true}).hide!==false)am.hide();O=1;}else return;aa(af);};function aa(af){if(N)af.data.preventDefault(1);else if(O)af.data.stopPropagation();};var ab=this._.element;this.on('show',function(){ab.on('keydown',Z,this);if(CKEDITOR.env.opera||CKEDITOR.env.gecko)ab.on('keypress',aa,this);});this.on('hide',function(){ab.removeListener('keydown',Z);if(CKEDITOR.env.opera||CKEDITOR.env.gecko)ab.removeListener('keypress',aa);W(function(af){g.apply(af);});});this.on('iframeAdded',function(af){var ag=new CKEDITOR.dom.document(af.data.iframe.$.contentWindow.document);ag.on('keydown',Z,this,null,0);});this.on('show',function(){var aj=this;X();if(F.config.dialog_startupFocusTab&&V._.pageCount>1){V._.tabBarMode=true;V._.tabs[V._.currentTabId][0].focus();}else if(!aj._.hasFocus){aj._.currentFocusIndex=-1;if(H.onFocus){var af=H.onFocus.call(aj);af&&af.focus();}else Y(1);if(aj._.editor.mode=='wysiwyg'&&CKEDITOR.env.ie){var ag=F.document.$.selection,ah=ag.createRange();if(ah)if(ah.parentElement&&ah.parentElement().ownerDocument==F.document.$||ah.item&&ah.item(0).ownerDocument==F.document.$){var ai=document.body.createTextRange();ai.moveToElementText(aj.getElement().getFirst().$);ai.collapse(true);ai.select();}}}},this,null,4294967295);if(CKEDITOR.env.ie6Compat)this.on('load',function(af){var ag=this.getElement(),ah=ag.getFirst();ah.remove();ah.appendTo(ag);},this);p(this);q(this);new CKEDITOR.dom.text(H.title,CKEDITOR.document).appendTo(this.parts.title);for(M=0;M<H.contents.length;M++){var ac=H.contents[M];ac&&this.addPage(ac);}this.parts.tabs.on('click',function(af){var ai=this;var ag=af.data.getTarget();if(ag.hasClass('cke_dialog_tab')){var ah=ag.$.id;ai.selectPage(ah.substring(4,ah.lastIndexOf('_')));if(ai._.tabBarMode){ai._.tabBarMode=false;ai._.currentFocusIndex=-1;Y(1);}af.data.preventDefault();}},this);var ad=[],ae=CKEDITOR.dialog._.uiElementBuilders.hbox.build(this,{type:'hbox',className:'cke_dialog_footer_buttons',widths:[],children:H.buttons},ad).getChild();this.parts.footer.setHtml(ad.join(''));for(M=0;M<ae.length;M++)this._.buttons[ae[M].id]=ae[M];};function h(F,G,H){this.element=G;this.focusIndex=H;this.tabIndex=0;this.isFocusable=function(){return!G.getAttribute('disabled')&&G.isVisible();};this.focus=function(){F._.currentFocusIndex=this.focusIndex;this.element.focus();};G.on('keydown',function(I){if(I.data.getKeystroke() in {32:1,13:1})this.fire('click');
});G.on('focus',function(){this.fire('mouseover');});G.on('blur',function(){this.fire('mouseout');});};function i(F){var G=CKEDITOR.document.getWindow();function H(){F.layout();};G.on('resize',H);F.on('hide',function(){G.removeListener('resize',H);});};CKEDITOR.dialog.prototype={destroy:function(){this.hide();this._.element.remove();},resize:(function(){return function(F,G){var H=this;if(H._.contentSize&&H._.contentSize.width==F&&H._.contentSize.height==G)return;CKEDITOR.dialog.fire('resize',{dialog:H,skin:H._.editor.skinName,width:F,height:G},H._.editor);H.fire('resize',{skin:H._.editor.skinName,width:F,height:G},H._.editor);if(H._.editor.lang.dir=='rtl'&&H._.position)H._.position.x=CKEDITOR.document.getWindow().getViewPaneSize().width-H._.contentSize.width-parseInt(H._.element.getFirst().getStyle('right'),10);H._.contentSize={width:F,height:G};};})(),getSize:function(){var F=this._.element.getFirst();return{width:F.$.offsetWidth||0,height:F.$.offsetHeight||0};},move:function(F,G,H){var P=this;var I=P._.element.getFirst(),J=P._.editor.lang.dir=='rtl',K=I.getComputedStyle('position')=='fixed';I.setStyle('zoom','100%');if(K&&P._.position&&P._.position.x==F&&P._.position.y==G)return;P._.position={x:F,y:G};if(!K){var L=CKEDITOR.document.getWindow().getScrollPosition();F+=L.x;G+=L.y;}if(J){var M=P.getSize(),N=CKEDITOR.document.getWindow().getViewPaneSize();F=N.width-M.width-F;}var O={top:(G>0?G:0)+'px'};O[J?'right':'left']=(F>0?F:0)+'px';I.setStyles(O);H&&(P._.moved=1);},getPosition:function(){return CKEDITOR.tools.extend({},this._.position);},show:function(){var F=this._.element,G=this.definition;if(!(F.getParent()&&F.getParent().equals(CKEDITOR.document.getBody())))F.appendTo(CKEDITOR.document.getBody());else F.setStyle('display','block');if(CKEDITOR.env.gecko&&CKEDITOR.env.version<10900){var H=this.parts.dialog;H.setStyle('position','absolute');setTimeout(function(){H.setStyle('position','fixed');},0);}this.resize(this._.contentSize&&this._.contentSize.width||G.width||G.minWidth,this._.contentSize&&this._.contentSize.height||G.height||G.minHeight);this.reset();this.selectPage(this.definition.contents[0].id);if(CKEDITOR.dialog._.currentZIndex===null)CKEDITOR.dialog._.currentZIndex=this._.editor.config.baseFloatZIndex;this._.element.getFirst().setStyle('z-index',CKEDITOR.dialog._.currentZIndex+=10);if(CKEDITOR.dialog._.currentTop===null){CKEDITOR.dialog._.currentTop=this;this._.parentDialog=null;v(this._.editor);}else{this._.parentDialog=CKEDITOR.dialog._.currentTop;
var I=this._.parentDialog.getElement().getFirst();I.$.style.zIndex-=Math.floor(this._.editor.config.baseFloatZIndex/2);CKEDITOR.dialog._.currentTop=this;}F.on('keydown',z);F.on(CKEDITOR.env.opera?'keypress':'keyup',A);this._.hasFocus=false;CKEDITOR.tools.setTimeout(function(){this.layout();i(this);this.parts.dialog.setStyle('visibility','');this.fireOnce('load',{});CKEDITOR.ui.fire('ready',this);this.fire('show',{});this._.editor.fire('dialogShow',this);this.foreach(function(J){J.setInitValue&&J.setInitValue();});},100,this);},layout:function(){var L=this;var F=L.parts.dialog,G=L.getSize(),H=CKEDITOR.document.getWindow(),I=H.getViewPaneSize(),J=(I.width-G.width)/2,K=(I.height-G.height)/2;if(!CKEDITOR.env.ie6Compat)if(G.height+(K>0?K:0)>I.height||G.width+(J>0?J:0)>I.width)F.setStyle('position','absolute');else F.setStyle('position','fixed');L.move(L._.moved?L._.position.x:J,L._.moved?L._.position.y:K);},foreach:function(F){var I=this;for(var G in I._.contents)for(var H in I._.contents[G])F.call(I,I._.contents[G][H]);return I;},reset:(function(){var F=function(G){if(G.reset)G.reset(1);};return function(){this.foreach(F);return this;};})(),setupContent:function(){var F=arguments;this.foreach(function(G){if(G.setup)G.setup.apply(G,F);});},commitContent:function(){var F=arguments;this.foreach(function(G){if(CKEDITOR.env.ie&&this._.currentFocusIndex==G.focusIndex)G.getInputElement().$.blur();if(G.commit)G.commit.apply(G,F);});},hide:function(){if(!this.parts.dialog.isVisible())return;this.fire('hide',{});this._.editor.fire('dialogHide',this);this.selectPage(this._.tabIdList[0]);var F=this._.element;F.setStyle('display','none');this.parts.dialog.setStyle('visibility','hidden');C(this);while(CKEDITOR.dialog._.currentTop!=this)CKEDITOR.dialog._.currentTop.hide();if(!this._.parentDialog)w();else{var G=this._.parentDialog.getElement().getFirst();G.setStyle('z-index',parseInt(G.$.style.zIndex,10)+Math.floor(this._.editor.config.baseFloatZIndex/2));}CKEDITOR.dialog._.currentTop=this._.parentDialog;if(!this._.parentDialog){CKEDITOR.dialog._.currentZIndex=null;F.removeListener('keydown',z);F.removeListener(CKEDITOR.env.opera?'keypress':'keyup',A);var H=this._.editor;H.focus();if(H.mode=='wysiwyg'&&CKEDITOR.env.ie){var I=H.getSelection();I&&I.unlock(true);}}else CKEDITOR.dialog._.currentZIndex-=10;delete this._.parentDialog;this.foreach(function(J){J.resetInitValue&&J.resetInitValue();});},addPage:function(F){var R=this;var G=[],H=F.label?' title="'+CKEDITOR.tools.htmlEncode(F.label)+'"':'',I=F.elements,J=CKEDITOR.dialog._.uiElementBuilders.vbox.build(R,{type:'vbox',className:'cke_dialog_page_contents',children:F.elements,expand:!!F.expand,padding:F.padding,style:F.style||'width: 100%;height:100%'},G),K=CKEDITOR.dom.element.createFromHtml(G.join(''));
K.setAttribute('role','tabpanel');var L=CKEDITOR.env,M='cke_'+F.id+'_'+CKEDITOR.tools.getNextNumber(),N=CKEDITOR.dom.element.createFromHtml(['<a class="cke_dialog_tab"',R._.pageCount>0?' cke_last':'cke_first',H,!!F.hidden?' style="display:none"':'',' id="',M,'"',L.gecko&&L.version>=10900&&!L.hc?'':' href="javascript:void(0)"',' tabIndex="-1"',' hidefocus="true"',' role="tab">',F.label,'</a>'].join(''));K.setAttribute('aria-labelledby',M);R._.tabs[F.id]=[N,K];R._.tabIdList.push(F.id);!F.hidden&&R._.pageCount++;R._.lastTab=N;R.updateStyle();var O=R._.contents[F.id]={},P,Q=J.getChild();while(P=Q.shift()){O[P.id]=P;if(typeof P.getChild=='function')Q.push.apply(Q,P.getChild());}K.setAttribute('name',F.id);K.appendTo(R.parts.contents);N.unselectable();R.parts.tabs.append(N);if(F.accessKey){B(R,R,'CTRL+'+F.accessKey,E,D);R._.accessKeyMap['CTRL+'+F.accessKey]=F.id;}},selectPage:function(F){if(this._.currentTabId==F)return;if(this.fire('selectPage',{page:F,currentPage:this._.currentTabId})===true)return;for(var G in this._.tabs){var H=this._.tabs[G][0],I=this._.tabs[G][1];if(G!=F){H.removeClass('cke_dialog_tab_selected');I.hide();}I.setAttribute('aria-hidden',G!=F);}var J=this._.tabs[F];J[0].addClass('cke_dialog_tab_selected');if(CKEDITOR.env.ie6Compat||CKEDITOR.env.ie7Compat){e(J[1]);J[1].show();setTimeout(function(){e(J[1],1);},0);}else J[1].show();this._.currentTabId=F;this._.currentTabIndex=CKEDITOR.tools.indexOf(this._.tabIdList,F);},updateStyle:function(){this.parts.dialog[(this._.pageCount===1?'add':'remove')+'Class']('cke_single_page');},hidePage:function(F){var H=this;var G=H._.tabs[F]&&H._.tabs[F][0];if(!G||H._.pageCount==1||!G.isVisible())return;else if(F==H._.currentTabId)H.selectPage(c.call(H));G.hide();H._.pageCount--;H.updateStyle();},showPage:function(F){var H=this;var G=H._.tabs[F]&&H._.tabs[F][0];if(!G)return;G.show();H._.pageCount++;H.updateStyle();},getElement:function(){return this._.element;},getName:function(){return this._.name;},getContentElement:function(F,G){var H=this._.contents[F];return H&&H[G];},getValueOf:function(F,G){return this.getContentElement(F,G).getValue();},setValueOf:function(F,G,H){return this.getContentElement(F,G).setValue(H);},getButton:function(F){return this._.buttons[F];},click:function(F){return this._.buttons[F].click();},disableButton:function(F){return this._.buttons[F].disable();},enableButton:function(F){return this._.buttons[F].enable();},getPageCount:function(){return this._.pageCount;},getParentEditor:function(){return this._.editor;
},getSelectedElement:function(){return this.getParentEditor().getSelection().getSelectedElement();},addFocusable:function(F,G){var I=this;if(typeof G=='undefined'){G=I._.focusList.length;I._.focusList.push(new h(I,F,G));}else{I._.focusList.splice(G,0,new h(I,F,G));for(var H=G+1;H<I._.focusList.length;H++)I._.focusList[H].focusIndex++;}}};CKEDITOR.tools.extend(CKEDITOR.dialog,{add:function(F,G){if(!this._.dialogDefinitions[F]||typeof G=='function')this._.dialogDefinitions[F]=G;},exists:function(F){return!!this._.dialogDefinitions[F];},getCurrent:function(){return CKEDITOR.dialog._.currentTop;},okButton:(function(){var F=function(G,H){H=H||{};return CKEDITOR.tools.extend({id:'ok',type:'button',label:G.lang.common.ok,'class':'cke_dialog_ui_button_ok',onClick:function(I){var J=I.data.dialog;if(J.fire('ok',{hide:true}).hide!==false)J.hide();}},H,true);};F.type='button';F.override=function(G){return CKEDITOR.tools.extend(function(H){return F(H,G);},{type:'button'},true);};return F;})(),cancelButton:(function(){var F=function(G,H){H=H||{};return CKEDITOR.tools.extend({id:'cancel',type:'button',label:G.lang.common.cancel,'class':'cke_dialog_ui_button_cancel',onClick:function(I){var J=I.data.dialog;if(J.fire('cancel',{hide:true}).hide!==false)J.hide();}},H,true);};F.type='button';F.override=function(G){return CKEDITOR.tools.extend(function(H){return F(H,G);},{type:'button'},true);};return F;})(),addUIElement:function(F,G){this._.uiElementBuilders[F]=G;}});CKEDITOR.dialog._={uiElementBuilders:{},dialogDefinitions:{},currentTop:null,currentZIndex:null};CKEDITOR.event.implementOn(CKEDITOR.dialog);CKEDITOR.event.implementOn(CKEDITOR.dialog.prototype,true);var j={resizable:CKEDITOR.DIALOG_RESIZE_BOTH,minWidth:600,minHeight:400,buttons:[CKEDITOR.dialog.okButton,CKEDITOR.dialog.cancelButton]},k=function(F,G,H){for(var I=0,J;J=F[I];I++){if(J.id==G)return J;if(H&&J[H]){var K=k(J[H],G,H);if(K)return K;}}return null;},l=function(F,G,H,I,J){if(H){for(var K=0,L;L=F[K];K++){if(L.id==H){F.splice(K,0,G);return G;}if(I&&L[I]){var M=l(L[I],G,H,I,true);if(M)return M;}}if(J)return null;}F.push(G);return G;},m=function(F,G,H){for(var I=0,J;J=F[I];I++){if(J.id==G)return F.splice(I,1);if(H&&J[H]){var K=m(J[H],G,H);if(K)return K;}}return null;},n=function(F,G){this.dialog=F;var H=G.contents;for(var I=0,J;J=H[I];I++)H[I]=J&&new o(F,J);CKEDITOR.tools.extend(this,G);};n.prototype={getContents:function(F){return k(this.contents,F);},getButton:function(F){return k(this.buttons,F);},addContents:function(F,G){return l(this.contents,F,G);
},addButton:function(F,G){return l(this.buttons,F,G);},removeContents:function(F){m(this.contents,F);},removeButton:function(F){m(this.buttons,F);}};function o(F,G){this._={dialog:F};CKEDITOR.tools.extend(this,G);};o.prototype={get:function(F){return k(this.elements,F,'children');},add:function(F,G){return l(this.elements,F,G,'children');},remove:function(F){m(this.elements,F,'children');}};function p(F){var G=null,H=null,I=F.getElement().getFirst(),J=F.getParentEditor(),K=J.config.dialog_magnetDistance,L=J.skin.margins||[0,0,0,0];if(typeof K=='undefined')K=20;function M(O){var P=F.getSize(),Q=CKEDITOR.document.getWindow().getViewPaneSize(),R=O.data.$.screenX,S=O.data.$.screenY,T=R-G.x,U=S-G.y,V,W;G={x:R,y:S};H.x+=T;H.y+=U;if(H.x+L[3]<K)V=-L[3];else if(H.x-L[1]>Q.width-P.width-K)V=Q.width-P.width+(J.lang.dir=='rtl'?0:L[1]);else V=H.x;if(H.y+L[0]<K)W=-L[0];else if(H.y-L[2]>Q.height-P.height-K)W=Q.height-P.height+L[2];else W=H.y;F.move(V,W,1);O.data.preventDefault();};function N(O){CKEDITOR.document.removeListener('mousemove',M);CKEDITOR.document.removeListener('mouseup',N);if(CKEDITOR.env.ie6Compat){var P=t.getChild(0).getFrameDocument();P.removeListener('mousemove',M);P.removeListener('mouseup',N);}};F.parts.title.on('mousedown',function(O){G={x:O.data.$.screenX,y:O.data.$.screenY};CKEDITOR.document.on('mousemove',M);CKEDITOR.document.on('mouseup',N);H=F.getPosition();if(CKEDITOR.env.ie6Compat){var P=t.getChild(0).getFrameDocument();P.on('mousemove',M);P.on('mouseup',N);}O.data.preventDefault();},F);};function q(F){var G=F.definition,H=G.resizable;if(H==CKEDITOR.DIALOG_RESIZE_NONE)return;var I=F.getParentEditor(),J,K,L,M,N,O,P=CKEDITOR.tools.addFunction(function(S){N=F.getSize();var T=F.parts.contents,U=T.$.getElementsByTagName('iframe').length;if(U){O=CKEDITOR.dom.element.createFromHtml('<div class="cke_dialog_resize_cover" style="height: 100%; position: absolute; width: 100%;"></div>');T.append(O);}K=N.height-F.parts.contents.getSize('height',!(CKEDITOR.env.gecko||CKEDITOR.env.opera||CKEDITOR.env.ie&&CKEDITOR.env.quirks));J=N.width-F.parts.contents.getSize('width',1);M={x:S.screenX,y:S.screenY};L=CKEDITOR.document.getWindow().getViewPaneSize();CKEDITOR.document.on('mousemove',Q);CKEDITOR.document.on('mouseup',R);if(CKEDITOR.env.ie6Compat){var V=t.getChild(0).getFrameDocument();V.on('mousemove',Q);V.on('mouseup',R);}S.preventDefault&&S.preventDefault();});F.on('load',function(){var S='';if(H==CKEDITOR.DIALOG_RESIZE_WIDTH)S=' cke_resizer_horizontal';else if(H==CKEDITOR.DIALOG_RESIZE_HEIGHT)S=' cke_resizer_vertical';
var T=CKEDITOR.dom.element.createFromHtml('<div class="cke_resizer'+S+' cke_resizer_'+I.lang.dir+'"'+' title="'+CKEDITOR.tools.htmlEncode(I.lang.resize)+'"'+' onmousedown="CKEDITOR.tools.callFunction('+P+', event )"></div>');F.parts.footer.append(T,1);});I.on('destroy',function(){CKEDITOR.tools.removeFunction(P);});function Q(S){var T=I.lang.dir=='rtl',U=(S.data.$.screenX-M.x)*(T?-1:1),V=S.data.$.screenY-M.y,W=N.width,X=N.height,Y=W+U*(F._.moved?1:2),Z=X+V*(F._.moved?1:2),aa=F._.element.getFirst(),ab=T&&aa.getComputedStyle('right'),ac=F.getPosition();if(ac.y+Z>L.height)Z=L.height-ac.y;if((T?ab:ac.x)+Y>L.width)Y=L.width-(T?ab:ac.x);if(H==CKEDITOR.DIALOG_RESIZE_WIDTH||H==CKEDITOR.DIALOG_RESIZE_BOTH)W=Math.max(G.minWidth||0,Y-J);if(H==CKEDITOR.DIALOG_RESIZE_HEIGHT||H==CKEDITOR.DIALOG_RESIZE_BOTH)X=Math.max(G.minHeight||0,Z-K);F.resize(W,X);if(!F._.moved)F.layout();S.data.preventDefault();};function R(){CKEDITOR.document.removeListener('mouseup',R);CKEDITOR.document.removeListener('mousemove',Q);if(O){O.remove();O=null;}if(CKEDITOR.env.ie6Compat){var S=t.getChild(0).getFrameDocument();S.removeListener('mouseup',R);S.removeListener('mousemove',Q);}};};var r,s={},t;function u(F){F.data.preventDefault(1);};function v(F){var G=CKEDITOR.document.getWindow(),H=F.config,I=H.dialog_backgroundCoverColor||'white',J=H.dialog_backgroundCoverOpacity,K=H.baseFloatZIndex,L=CKEDITOR.tools.genKey(I,J,K),M=s[L];if(!M){var N=['<div tabIndex="-1" style="position: ',CKEDITOR.env.ie6Compat?'absolute':'fixed','; z-index: ',K,'; top: 0px; left: 0px; ',!CKEDITOR.env.ie6Compat?'background-color: '+I:'','" class="cke_dialog_background_cover">'];if(CKEDITOR.env.ie6Compat){var O=CKEDITOR.env.isCustomDomain(),P="<html><body style=\\'background-color:"+I+";\\'></body></html>";N.push('<iframe hidefocus="true" frameborder="0" id="cke_dialog_background_iframe" src="javascript:');N.push('void((function(){document.open();'+(O?"document.domain='"+document.domain+"';":'')+"document.write( '"+P+"' );"+'document.close();'+'})())');N.push('" style="position:absolute;left:0;top:0;width:100%;height: 100%;progid:DXImageTransform.Microsoft.Alpha(opacity=0)"></iframe>');}N.push('</div>');M=CKEDITOR.dom.element.createFromHtml(N.join(''));M.setOpacity(J!=undefined?J:0.5);M.on('keydown',u);M.on('keypress',u);M.on('keyup',u);M.appendTo(CKEDITOR.document.getBody());s[L]=M;}else M.show();t=M;var Q=function(){var T=G.getViewPaneSize();M.setStyles({width:T.width+'px',height:T.height+'px'});},R=function(){var T=G.getScrollPosition(),U=CKEDITOR.dialog._.currentTop;
M.setStyles({left:T.x+'px',top:T.y+'px'});if(U)do{var V=U.getPosition();U.move(V.x,V.y);}while(U=U._.parentDialog)};r=Q;G.on('resize',Q);Q();if(!(CKEDITOR.env.mac&&CKEDITOR.env.webkit))M.focus();if(CKEDITOR.env.ie6Compat){var S=function(){R();arguments.callee.prevScrollHandler.apply(this,arguments);};G.$.setTimeout(function(){S.prevScrollHandler=window.onscroll||(function(){});window.onscroll=S;},0);R();}};function w(){if(!t)return;var F=CKEDITOR.document.getWindow();t.hide();F.removeListener('resize',r);if(CKEDITOR.env.ie6Compat)F.$.setTimeout(function(){var G=window.onscroll&&window.onscroll.prevScrollHandler;window.onscroll=G||null;},0);r=null;};function x(){for(var F in s)s[F].remove();s={};};var y={},z=function(F){var G=F.data.$.ctrlKey||F.data.$.metaKey,H=F.data.$.altKey,I=F.data.$.shiftKey,J=String.fromCharCode(F.data.$.keyCode),K=y[(G?'CTRL+':'')+(H?'ALT+':'')+(I?'SHIFT+':'')+J];if(!K||!K.length)return;K=K[K.length-1];K.keydown&&K.keydown.call(K.uiElement,K.dialog,K.key);F.data.preventDefault();},A=function(F){var G=F.data.$.ctrlKey||F.data.$.metaKey,H=F.data.$.altKey,I=F.data.$.shiftKey,J=String.fromCharCode(F.data.$.keyCode),K=y[(G?'CTRL+':'')+(H?'ALT+':'')+(I?'SHIFT+':'')+J];if(!K||!K.length)return;K=K[K.length-1];if(K.keyup){K.keyup.call(K.uiElement,K.dialog,K.key);F.data.preventDefault();}},B=function(F,G,H,I,J){var K=y[H]||(y[H]=[]);K.push({uiElement:F,dialog:G,key:H,keyup:J||F.accessKeyUp,keydown:I||F.accessKeyDown});},C=function(F){for(var G in y){var H=y[G];for(var I=H.length-1;I>=0;I--){if(H[I].dialog==F||H[I].uiElement==F)H.splice(I,1);}if(H.length===0)delete y[G];}},D=function(F,G){if(F._.accessKeyMap[G])F.selectPage(F._.accessKeyMap[G]);},E=function(F,G){};(function(){CKEDITOR.ui.dialog={uiElement:function(F,G,H,I,J,K,L){if(arguments.length<4)return;var M=(I.call?I(G):I)||'div',N=['<',M,' '],O=(J&&J.call?J(G):J)||{},P=(K&&K.call?K(G):K)||{},Q=(L&&L.call?L.call(this,F,G):L)||'',R=this.domId=P.id||CKEDITOR.tools.getNextId()+'_uiElement',S=this.id=G.id,T;P.id=R;var U={};if(G.type)U['cke_dialog_ui_'+G.type]=1;if(G.className)U[G.className]=1;if(G.disabled)U.cke_disabled=1;var V=P['class']&&P['class'].split?P['class'].split(' '):[];for(T=0;T<V.length;T++){if(V[T])U[V[T]]=1;}var W=[];for(T in U)W.push(T);P['class']=W.join(' ');if(G.title)P.title=G.title;var X=(G.style||'').split(';');if(G.align){var Y=G.align;O['margin-left']=Y=='left'?0:'auto';O['margin-right']=Y=='right'?0:'auto';}for(T in O)X.push(T+':'+O[T]);if(G.hidden)X.push('display:none');
for(T=X.length-1;T>=0;T--){if(X[T]==='')X.splice(T,1);}if(X.length>0)P.style=(P.style?P.style+'; ':'')+X.join('; ');for(T in P)N.push(T+'="'+CKEDITOR.tools.htmlEncode(P[T])+'" ');N.push('>',Q,'</',M,'>');H.push(N.join(''));(this._||(this._={})).dialog=F;if(typeof G.isChanged=='boolean')this.isChanged=function(){return G.isChanged;};if(typeof G.isChanged=='function')this.isChanged=G.isChanged;if(typeof G.setValue=='function')this.setValue=CKEDITOR.tools.override(this.setValue,function(aa){return function(ab){aa.call(this,G.setValue.call(this,ab));};});if(typeof G.getValue=='function')this.getValue=CKEDITOR.tools.override(this.getValue,function(aa){return function(){return G.getValue.call(this,aa.call(this));};});CKEDITOR.event.implementOn(this);this.registerEvents(G);if(this.accessKeyUp&&this.accessKeyDown&&G.accessKey)B(this,F,'CTRL+'+G.accessKey);var Z=this;F.on('load',function(){var aa=Z.getInputElement();if(aa){var ab=Z.type in {checkbox:1,ratio:1}&&CKEDITOR.env.ie&&CKEDITOR.env.version<8?'cke_dialog_ui_focused':'';aa.on('focus',function(){F._.tabBarMode=false;F._.hasFocus=true;Z.fire('focus');ab&&this.addClass(ab);});aa.on('blur',function(){Z.fire('blur');ab&&this.removeClass(ab);});}});if(this.keyboardFocusable){this.tabIndex=G.tabIndex||0;this.focusIndex=F._.focusList.push(this)-1;this.on('focus',function(){F._.currentFocusIndex=Z.focusIndex;});}CKEDITOR.tools.extend(this,G);},hbox:function(F,G,H,I,J){if(arguments.length<4)return;this._||(this._={});var K=this._.children=G,L=J&&J.widths||null,M=J&&J.height||null,N={},O,P=function(){var R=['<tbody><tr class="cke_dialog_ui_hbox">'];for(O=0;O<H.length;O++){var S='cke_dialog_ui_hbox_child',T=[];if(O===0)S='cke_dialog_ui_hbox_first';if(O==H.length-1)S='cke_dialog_ui_hbox_last';R.push('<td class="',S,'" role="presentation" ');if(L){if(L[O])T.push('width:'+a(L[O]));}else T.push('width:'+Math.floor(100/H.length)+'%');if(M)T.push('height:'+a(M));if(J&&J.padding!=undefined)T.push('padding:'+a(J.padding));if(CKEDITOR.env.ie&&CKEDITOR.env.quirks&&K[O].align)T.push('text-align:'+K[O].align);if(T.length>0)R.push('style="'+T.join('; ')+'" ');R.push('>',H[O],'</td>');}R.push('</tr></tbody>');return R.join('');},Q={role:'presentation'};J&&J.align&&(Q.align=J.align);CKEDITOR.ui.dialog.uiElement.call(this,F,J||{type:'hbox'},I,'table',N,Q,P);},vbox:function(F,G,H,I,J){if(arguments.length<3)return;this._||(this._={});var K=this._.children=G,L=J&&J.width||null,M=J&&J.heights||null,N=function(){var O=['<table role="presentation" cellspacing="0" border="0" '];
O.push('style="');if(J&&J.expand)O.push('height:100%;');O.push('width:'+a(L||'100%'),';');O.push('"');O.push('align="',CKEDITOR.tools.htmlEncode(J&&J.align||(F.getParentEditor().lang.dir=='ltr'?'left':'right')),'" ');O.push('><tbody>');for(var P=0;P<H.length;P++){var Q=[];O.push('<tr><td role="presentation" ');if(L)Q.push('width:'+a(L||'100%'));if(M)Q.push('height:'+a(M[P]));else if(J&&J.expand)Q.push('height:'+Math.floor(100/H.length)+'%');if(J&&J.padding!=undefined)Q.push('padding:'+a(J.padding));if(CKEDITOR.env.ie&&CKEDITOR.env.quirks&&K[P].align)Q.push('text-align:'+K[P].align);if(Q.length>0)O.push('style="',Q.join('; '),'" ');O.push(' class="cke_dialog_ui_vbox_child">',H[P],'</td></tr>');}O.push('</tbody></table>');return O.join('');};CKEDITOR.ui.dialog.uiElement.call(this,F,J||{type:'vbox'},I,'div',null,{role:'presentation'},N);}};})();CKEDITOR.ui.dialog.uiElement.prototype={getElement:function(){return CKEDITOR.document.getById(this.domId);},getInputElement:function(){return this.getElement();},getDialog:function(){return this._.dialog;},setValue:function(F,G){this.getInputElement().setValue(F);!G&&this.fire('change',{value:F});return this;},getValue:function(){return this.getInputElement().getValue();},isChanged:function(){return false;},selectParentTab:function(){var I=this;var F=I.getInputElement(),G=F,H;while((G=G.getParent())&&G.$.className.search('cke_dialog_page_contents')==-1){}if(!G)return I;H=G.getAttribute('name');if(I._.dialog._.currentTabId!=H)I._.dialog.selectPage(H);return I;},focus:function(){this.selectParentTab().getInputElement().focus();return this;},registerEvents:function(F){var G=/^on([A-Z]\w+)/,H,I=function(K,L,M,N){L.on('load',function(){K.getInputElement().on(M,N,K);});};for(var J in F){if(!(H=J.match(G)))continue;if(this.eventProcessors[J])this.eventProcessors[J].call(this,this._.dialog,F[J]);else I(this,this._.dialog,H[1].toLowerCase(),F[J]);}return this;},eventProcessors:{onLoad:function(F,G){F.on('load',G,this);},onShow:function(F,G){F.on('show',G,this);},onHide:function(F,G){F.on('hide',G,this);}},accessKeyDown:function(F,G){this.focus();},accessKeyUp:function(F,G){},disable:function(){var F=this.getElement(),G=this.getInputElement();G.setAttribute('disabled','true');F.addClass('cke_disabled');},enable:function(){var F=this.getElement(),G=this.getInputElement();G.removeAttribute('disabled');F.removeClass('cke_disabled');},isEnabled:function(){return!this.getElement().hasClass('cke_disabled');},isVisible:function(){return this.getInputElement().isVisible();
},isFocusable:function(){if(!this.isEnabled()||!this.isVisible())return false;return true;}};CKEDITOR.ui.dialog.hbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement(),{getChild:function(F){var G=this;if(arguments.length<1)return G._.children.concat();if(!F.splice)F=[F];if(F.length<2)return G._.children[F[0]];else return G._.children[F[0]]&&G._.children[F[0]].getChild?G._.children[F[0]].getChild(F.slice(1,F.length)):null;}},true);CKEDITOR.ui.dialog.vbox.prototype=new CKEDITOR.ui.dialog.hbox();(function(){var F={build:function(G,H,I){var J=H.children,K,L=[],M=[];for(var N=0;N<J.length&&(K=J[N]);N++){var O=[];L.push(O);M.push(CKEDITOR.dialog._.uiElementBuilders[K.type].build(G,K,O));}return new CKEDITOR.ui.dialog[H.type](G,M,L,I,H);}};CKEDITOR.dialog.addUIElement('hbox',F);CKEDITOR.dialog.addUIElement('vbox',F);})();CKEDITOR.dialogCommand=function(F){this.dialogName=F;};CKEDITOR.dialogCommand.prototype={exec:function(F){CKEDITOR.env.opera?CKEDITOR.tools.setTimeout(function(){F.openDialog(this.dialogName);},0,this):F.openDialog(this.dialogName);},canUndo:false,editorFocus:CKEDITOR.env.ie||CKEDITOR.env.webkit};(function(){var F=/^([a]|[^a])+$/,G=/^\d*$/,H=/^\d*(?:\.\d+)?$/,I=/^(((\d*(\.\d+))|(\d*))(px|\%)?)?$/,J=/^(((\d*(\.\d+))|(\d*))(px|em|ex|in|cm|mm|pt|pc|\%)?)?$/i,K=/^(\s*[\w-]+\s*:\s*[^:;]+(?:;|$))*$/;CKEDITOR.VALIDATE_OR=1;CKEDITOR.VALIDATE_AND=2;CKEDITOR.dialog.validate={functions:function(){var L=arguments;return function(){var M=this&&this.getValue?this.getValue():L[0],N=undefined,O=CKEDITOR.VALIDATE_AND,P=[],Q;for(Q=0;Q<L.length;Q++){if(typeof L[Q]=='function')P.push(L[Q]);else break;}if(Q<L.length&&typeof L[Q]=='string'){N=L[Q];Q++;}if(Q<L.length&&typeof L[Q]=='number')O=L[Q];var R=O==CKEDITOR.VALIDATE_AND?true:false;for(Q=0;Q<P.length;Q++){if(O==CKEDITOR.VALIDATE_AND)R=R&&P[Q](M);else R=R||P[Q](M);}return!R?N:true;};},regex:function(L,M){return function(){var N=this&&this.getValue?this.getValue():arguments[0];return!L.test(N)?M:true;};},notEmpty:function(L){return this.regex(F,L);},integer:function(L){return this.regex(G,L);},number:function(L){return this.regex(H,L);},cssLength:function(L){return this.functions(function(M){return J.test(CKEDITOR.tools.trim(M));},L);},htmlLength:function(L){return this.functions(function(M){return I.test(CKEDITOR.tools.trim(M));},L);},inlineStyle:function(L){return this.functions(function(M){return K.test(CKEDITOR.tools.trim(M));},L);},equals:function(L,M){return this.functions(function(N){return N==L;
},M);},notEqual:function(L,M){return this.functions(function(N){return N!=L;},M);}};CKEDITOR.on('instanceDestroyed',function(L){if(CKEDITOR.tools.isEmpty(CKEDITOR.instances)){var M;while(M=CKEDITOR.dialog._.currentTop)M.hide();x();}var N=L.editor._.storedDialogs;for(var O in N)N[O].destroy();});})();CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{openDialog:function(F,G){if(this.mode=='wysiwyg'&&CKEDITOR.env.ie){var H=this.getSelection();H&&H.lock();}var I=CKEDITOR.dialog._.dialogDefinitions[F],J=this.skin.dialog;if(CKEDITOR.dialog._.currentTop===null)v(this);if(typeof I=='function'&&J._isLoaded){var K=this._.storedDialogs||(this._.storedDialogs={}),L=K[F]||(K[F]=new CKEDITOR.dialog(this,F));G&&G.call(L,L);L.show();return L;}else if(I=='failed'){w();throw new Error('[CKEDITOR.dialog.openDialog] Dialog "'+F+'" failed when loading definition.');}var M=this;function N(P){var Q=CKEDITOR.dialog._.dialogDefinitions[F],R=M.skin.dialog;if(!R._isLoaded||O&&typeof P=='undefined')return;if(typeof Q!='function')CKEDITOR.dialog._.dialogDefinitions[F]='failed';M.openDialog(F,G);};if(typeof I=='string'){var O=1;CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(I),N,null,0,1);}CKEDITOR.skins.load(this,'dialog',N);return null;}});})();CKEDITOR.plugins.add('dialog',{requires:['dialogui']});
