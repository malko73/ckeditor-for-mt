(function(){var a=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,b='{cke_protected}';function c(I){var J=I.children.length,K=I.children[J-1];while(K&&K.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(K.value))K=I.children[--J];return K;};function d(I){var J=I.parent;return J?CKEDITOR.tools.indexOf(J.children,I):-1;};function e(I,J){var K=I.children,L=c(I);if(L){if((J||!CKEDITOR.env.ie)&&L.type==CKEDITOR.NODE_ELEMENT&&L.name=='br')K.pop();if(L.type==CKEDITOR.NODE_TEXT&&a.test(L.value))K.pop();}};function f(I,J,K){if(!J&&(!K||typeof K=='function'&&K(I)===false))return false;if(J&&CKEDITOR.env.ie&&(document.documentMode>7||I.name in CKEDITOR.dtd.tr||I.name in CKEDITOR.dtd.$listItem))return false;var L=c(I);return!L||L&&(L.type==CKEDITOR.NODE_ELEMENT&&L.name=='br'||I.name=='form'&&L.name=='input');};function g(I,J){return function(K){e(K,!I);if(f(K,!I,J))if(I||CKEDITOR.env.ie)K.add(new CKEDITOR.htmlParser.text('\xa0'));else K.add(new CKEDITOR.htmlParser.element('br',{}));};};var h=CKEDITOR.dtd,i=['caption','colgroup','col','thead','tfoot','tbody'],j=CKEDITOR.tools.extend({},h.$block,h.$listItem,h.$tableContent);for(var k in j){if(!('br' in h[k]))delete j[k];}delete j.pre;var l={elements:{},attributeNames:[[/^on/,'data-cke-pa-on']]},m={elements:{}};for(k in j)m.elements[k]=g();var n={elementNames:[[/^cke:/,''],[/^\?xml:namespace$/,'']],attributeNames:[[/^data-cke-(saved|pa)-/,''],[/^data-cke-.*/,''],['hidefocus','']],elements:{$:function(I){var J=I.attributes;if(J){if(J['data-cke-temp'])return false;var K=['name','href','src'],L;for(var M=0;M<K.length;M++){L='data-cke-saved-'+K[M];L in J&&delete J[K[M]];}}return I;},table:function(I){var J=I.children.slice(0);J.sort(function(K,L){var M,N;if(K.type==CKEDITOR.NODE_ELEMENT&&L.type==K.type){M=CKEDITOR.tools.indexOf(i,K.name);N=CKEDITOR.tools.indexOf(i,L.name);}if(!(M>-1&&N>-1&&M!=N)){M=d(K);N=d(L);}return M>N?1:-1;});},embed:function(I){var J=I.parent;if(J&&J.name=='object'){var K=J.attributes.width,L=J.attributes.height;K&&(I.attributes.width=K);L&&(I.attributes.height=L);}},param:function(I){I.children=[];I.isEmpty=true;return I;},a:function(I){if(!(I.children.length||I.attributes.name||I.attributes['data-cke-saved-name']))return false;},span:function(I){if(I.attributes['class']=='Apple-style-span')delete I.name;},pre:function(I){CKEDITOR.env.ie&&e(I);},html:function(I){delete I.attributes.contenteditable;delete I.attributes['class'];},body:function(I){delete I.attributes.spellcheck;delete I.attributes.contenteditable;},style:function(I){var J=I.children[0];
J&&J.value&&(J.value=CKEDITOR.tools.trim(J.value));if(!I.attributes.type)I.attributes.type='text/css';},title:function(I){var J=I.children[0];J&&(J.value=I.attributes['data-cke-title']||'');}},attributes:{'class':function(I,J){return CKEDITOR.tools.ltrim(I.replace(/(?:^|\s+)cke_[^\s]*/g,''))||false;}}};if(CKEDITOR.env.ie)n.attributes.style=function(I,J){return I.replace(/(^|;)([^\:]+)/g,function(K){return K.toLowerCase();});};function o(I){var J=I.attributes;if(J.contenteditable!='false')J['data-cke-editable']=J.contenteditable?'true':1;J.contenteditable='false';};function p(I){var J=I.attributes;switch(J['data-cke-editable']){case 'true':J.contenteditable='true';break;case '1':delete J.contenteditable;break;}};for(k in {input:1,textarea:1}){l.elements[k]=o;n.elements[k]=p;}var q=/<(a|area|img|input|source)\b([^>]*)>/gi,r=/\b(on\w+|href|src|name)\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|(?:[^ "'>]+))/gi,s=/(?:<style(?=[ >])[^>]*>[\s\S]*<\/style>)|(?:<(:?link|meta|base)[^>]*>)/gi,t=/<cke:encoded>([^<]*)<\/cke:encoded>/gi,u=/(<\/?)((?:object|embed|param|html|body|head|title)[^>]*>)/gi,v=/(<\/?)cke:((?:html|body|head|title)[^>]*>)/gi,w=/<cke:(param|embed)([^>]*?)\/?>(?!\s*<\/cke:\1)/gi;function x(I){return I.replace(q,function(J,K,L){return '<'+K+L.replace(r,function(M,N){if(!/^on/.test(N)&&L.indexOf('data-cke-saved-'+N)==-1)return ' data-cke-saved-'+M+' data-cke-'+CKEDITOR.rnd+'-'+M;return M;})+'>';});};function y(I){return I.replace(s,function(J){return '<cke:encoded>'+encodeURIComponent(J)+'</cke:encoded>';});};function z(I){return I.replace(t,function(J,K){return decodeURIComponent(K);});};function A(I){return I.replace(u,'$1cke:$2');};function B(I){return I.replace(v,'$1$2');};function C(I){return I.replace(w,'<cke:$1$2></cke:$1>');};function D(I){return I.replace(/(<pre\b[^>]*>)(\r\n|\n)/g,'$1$2$2');};function E(I){return I.replace(/<!--(?!{cke_protected})[\s\S]+?-->/g,function(J){return '<!--'+b+'{C}'+encodeURIComponent(J).replace(/--/g,'%2D%2D')+'-->';});};function F(I){return I.replace(/<!--\{cke_protected\}\{C\}([\s\S]+?)-->/g,function(J,K){return decodeURIComponent(K);});};function G(I,J){var K=J._.dataStore;return I.replace(/<!--\{cke_protected\}([\s\S]+?)-->/g,function(L,M){return decodeURIComponent(M);}).replace(/\{cke_protected_(\d+)\}/g,function(L,M){return K&&K[M]||'';});};function H(I,J){var K=[],L=J.config.protectedSource,M=J._.dataStore||(J._.dataStore={id:1}),N=/<\!--\{cke_temp(comment)?\}(\d*?)-->/g,O=[/<script[\s\S]*?<\/script>/gi,/<noscript[\s\S]*?<\/noscript>/gi].concat(L);
I=I.replace(/<!--[\s\S]*?-->/g,function(Q){return '<!--{cke_tempcomment}'+(K.push(Q)-1)+'-->';});for(var P=0;P<O.length;P++)I=I.replace(O[P],function(Q){Q=Q.replace(N,function(R,S,T){return K[T];});return/cke_temp(comment)?/.test(Q)?Q:'<!--{cke_temp}'+(K.push(Q)-1)+'-->';});I=I.replace(N,function(Q,R,S){return '<!--'+b+(R?'{C}':'')+encodeURIComponent(K[S]).replace(/--/g,'%2D%2D')+'-->';});return I.replace(/(['"]).*?\1/g,function(Q){return Q.replace(/<!--\{cke_protected\}([\s\S]+?)-->/g,function(R,S){M[M.id]=decodeURIComponent(S);return '{cke_protected_'+M.id++ +'}';});});};CKEDITOR.plugins.add('htmldataprocessor',{requires:['htmlwriter'],init:function(I){var J=I.dataProcessor=new CKEDITOR.htmlDataProcessor(I);J.writer.forceSimpleAmpersand=I.config.forceSimpleAmpersand;J.dataFilter.addRules(l);J.dataFilter.addRules(m);J.htmlFilter.addRules(n);var K={elements:{}};for(k in j)K.elements[k]=g(true,I.config.fillEmptyBlocks);J.htmlFilter.addRules(K);},onLoad:function(){!('fillEmptyBlocks' in CKEDITOR.config)&&(CKEDITOR.config.fillEmptyBlocks=1);}});CKEDITOR.htmlDataProcessor=function(I){var J=this;J.editor=I;J.writer=new CKEDITOR.htmlWriter();J.dataFilter=new CKEDITOR.htmlParser.filter();J.htmlFilter=new CKEDITOR.htmlParser.filter();};CKEDITOR.htmlDataProcessor.prototype={toHtml:function(I,J){I=H(I,this.editor);I=x(I);I=y(I);I=A(I);I=C(I);I=D(I);var K=new CKEDITOR.dom.element('div');K.setHtml('a'+I);I=K.getHtml().substr(1);I=I.replace(new RegExp(' data-cke-'+CKEDITOR.rnd+'-','ig'),' ');I=B(I);I=z(I);I=F(I);var L=CKEDITOR.htmlParser.fragment.fromHtml(I,J),M=new CKEDITOR.htmlParser.basicWriter();L.writeHtml(M,this.dataFilter);I=M.getHtml(true);I=E(I);return I;},toDataFormat:function(I,J){var K=this.writer,L=CKEDITOR.htmlParser.fragment.fromHtml(I,J);K.reset();L.writeHtml(K,this.htmlFilter);var M=K.getHtml(true);M=F(M);M=G(M,this.editor);return M;}};})();
